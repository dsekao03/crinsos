
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>수세 메모</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html {
      font-size: 15px;
    }

    body {
      font-family: '맑은 고딕', 'Malgun Gothic', 'Apple SD Gothic Neo', Arial, sans-serif;
      margin: 0;
      background: #f9f9f9;
    }

    .container {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-start;
      gap: 1.35rem;
      margin: 27px 5px;
    }

    .memo-section {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 1.5px 12px #e3e3ec;
      padding: 1.4rem 1.18rem 1.1rem 1.18rem;
      width: 166px;
      min-width: 144px;
      max-width: 176px;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      gap: 13px;
      font-size: 1rem;
    }
    h1 {
      text-align: center;
      margin-bottom: 1.35rem;
      letter-spacing: -1.2px;
      font-size: 1.35rem;
      font-weight: 800;
    }
    .memoinput-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    label {
      font-size: 1rem;
      margin-bottom: 2px;
      color: #343365;
      font-weight: 600;
      letter-spacing: -0.4px;
      min-width: 56px;
    }
    .memoline {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 1px;
    }
    .memo-small {
      min-width: 18px;
      max-width: 48px;
      font-size: 1em !important;
      padding: 3px 6px !important;
      margin-right: 3px;
      background: #f1f3ff !important;
      border: 1px solid #c8d2ff;
      border-radius: 3.5px;
      text-align: center;
      height: 22px !important;
      resize: none;
      box-sizing: border-box;
    }
    input[type="text"].memo-small {
      width: auto !important;
    }
    input[type="text"].memo-auto {
      min-width: 30px;
      max-width: 134px;
      width: auto;
    }
    input[type="text"] {
      padding: 3.5px 5px;
      border: 1.4px solid #acbaff;
      border-radius: 5px;
      font-size: 1.08rem;
      outline: none;
      background: #f4f6fa;
      transition: border 0.2s;
      height: 23px;
      width: 71px;
      box-sizing: border-box;
    }
    input[type="text"]:focus {
      border: 12px solid #798ef7;
      background: #e6ebff;
    }
    input[type="checkbox"].memocheck {
      width: 15px;
      height: 15px;
      accent-color: #7a77ee;
      margin-left: 2.5px;
      margin-right: 0px;
      vertical-align: middle;
      flex-shrink: 0;
      border-radius: 5px;
      box-shadow: 0px 1.5px 3px #e8ebf7;
    }
    .actions {
      display: flex;
      gap: 1.12rem;
      margin-top: 8px;
    }
    button {
      padding: 6px 15px;
      font-size: 1.03rem;
      border-radius: 7px;
      border: none;
      background: #7a77ee;
      color: #fff;
      cursor: pointer;
      transition: background 0.17s, box-shadow 0.12s;
    }
    button:hover {
      background: #5956d2;
      box-shadow: 0 2px 8px #d9d8f7;
    }
    .reset-top-center-wrap {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-top: 15px;
      margin-bottom: -10px;
    }
    .reset-top-center-wrap button {
      font-size: 1.14rem;
      padding: 7px 31px;
      border-radius: 20px;
      box-shadow: 0 2px 9px #edefff;
      background: #7a77ee;
      font-weight: bold;
    }
    .result-area {
      padding: 0.87rem;
      border-radius: 10px;
      min-height: 72px;
      margin-top: 7px;
      background: #f7f8fc;
      box-shadow: 0 1.1px 7px #ebeafe;
      color: #2d2d41;
      word-break: break-all;
      font-size: 1.12rem;
    }
    .group-title {
      font-weight: bold;
      color: #335;
      margin-bottom: 7px;
      font-size: 1.08rem;
      letter-spacing: -0.5px;
      margin-top: 10px;
    }

    @media (max-width: 1050px) {
      .container {
        flex-direction: column;
        align-items: stretch;
        gap: 1.4rem;
        margin: 19px 0.5vw;
      }
      .memo-section {
        width: 99vw;
        min-width: unset;
        margin: 0 auto;
        max-width: 288px;
      }
      .result-area {
        min-height: 47px;
      }
    }

    @media (max-width: 700px) {
      html {
        font-size: 13.2px;
      }
      .container {
        margin: 10px 2vw;
        gap: 1.1rem;
      }
      .memo-section {
        padding: 1.07rem 0.43rem 1.16rem 0.35rem;
        font-size: 0.91rem;
        max-width: 99vw;
      }
      h1 {
        font-size: 0.88rem;
      }
      input[type="text"] {
        font-size: 0.82rem;
        padding: 2.2px 3.6px;
        height: 18px;
        width: 48px;
      }
      .memo-small {
        min-width: 14px;
        max-width: 37px;
        font-size: 0.95em !important;
        padding: 2px 1.6px !important;
        height: 15px !important;
        width: auto !important;
      }
      button {
        font-size: 0.81rem;
        padding: 5px 13px;
      }
      .reset-top-center-wrap button {
        font-size: 0.81rem;
        padding: 5px 15px;
      }
      .reset-top-center-wrap {
        margin-top: 9px;
        margin-bottom: -4px;
      }
      input[type="checkbox"].memocheck {
        width: 12.5px;
        height: 12.5px;
      }
    }

    @media (max-width: 410px) {
      html {
        font-size: 12.2px;
      }
      .memo-section {
        padding: 0.43rem 0.13rem 0.4rem 0.09rem;
        min-width: unset;
        max-width: 100vw;
      }
      .result-area {
        padding: 0.34rem;
        min-height: 23px;
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <div class="reset-top-center-wrap">
    <button id="resetBtn">초기화</button>
  </div>
  <div class="container">
    <!-- 좌측 메모입력란 -->
    <div class="memo-section" id="memoSection1">
      <div class="memoinput-group">
        <div class="group-title">A 건조</div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo1s" autocomplete="off" placeholder="Lot">
          <label for="memo1">건조 1</label>
          <input type="text" id="memo1" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check1">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo2s" autocomplete="off" placeholder="Lot">
          <label for="memo2">건조 2</label>
          <input type="text" id="memo2" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check2">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo3s" autocomplete="off" placeholder="Lot">
          <label for="memo3">건조 3</label>
          <input type="text" id="memo3" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check3">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo4s" autocomplete="off" placeholder="Lot">
          <label for="memo4">건조 4</label>
          <input type="text" id="memo4" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check4">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo5s" autocomplete="off" placeholder="Lot">
          <label for="memo5">건조 5</label>
          <input type="text" id="memo5" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check5">
        </div>
      </div>
      <div class="memoinput-group">
        <div class="group-title">A 배합</div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo6s" autocomplete="off" placeholder="Lot">
          <label for="memo6">배합1</label>
          <input type="text" id="memo6" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check6">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo7s" autocomplete="off" placeholder="Lot">
          <label for="memo7">배합2</label>
          <input type="text" id="memo7" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check7">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo8s" autocomplete="off" placeholder="Lot">
          <label for="memo8">배합3</label>
          <input type="text" id="memo8" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check8">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo9s" autocomplete="off" placeholder="Lot">
          <label for="memo9">배합4</label>
          <input type="text" id="memo9" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check9">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo10s" autocomplete="off" placeholder="Lot">
          <label for="memo10">배합5</label>
          <input type="text" id="memo10" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check10">
        </div>
      </div>
    </div>

    <!-- 결과 박스 (모든 입력 메모 표시, 우측 고정) -->
    <div class="memo-section">
      <div class="group-title">A라인</div>
      <div class="result-area" id="resultArea"></div>
    </div>

    <!-- 추가: 두 번째 메모입력란 -->
    <div class="memo-section" id="memoSection2">
      <div class="memoinput-group">
        <div class="group-title">건조 11 ~ 15</div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo11s" autocomplete="off" placeholder="Lot">
          <label for="memo11">건조 11</label>
          <input type="text" id="memo11" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check11">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo12s" autocomplete="off" placeholder="Lot">
          <label for="memo12">건조 12</label>
          <input type="text" id="memo12" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check12">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo13s" autocomplete="off" placeholder="Lot">
          <label for="memo13">건조 13</label>
          <input type="text" id="memo13" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check13">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo14s" autocomplete="off" placeholder="Lot">
          <label for="memo14">건조 14</label>
          <input type="text" id="memo14" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check14">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo15s" autocomplete="off" placeholder="Lot">
          <label for="memo15">건조 15</label>
          <input type="text" id="memo15" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check15">
        </div>
      </div>
      <div class="memoinput-group">
        <div class="group-title">배합 16 ~ 20</div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo16s" autocomplete="off" placeholder="Lot">
          <label for="memo16">배합 16</label>
          <input type="text" id="memo16" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check16">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo17s" autocomplete="off" placeholder="Lot">
          <label for="memo17">배합 17</label>
          <input type="text" id="memo17" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check17">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo18s" autocomplete="off" placeholder="Lot">
          <label for="memo18">배합 18</label>
          <input type="text" id="memo18" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check18">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo19s" autocomplete="off" placeholder="Lot">
          <label for="memo19">배합 19</label>
          <input type="text" id="memo19" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check19">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo20s" autocomplete="off" placeholder="Lot">
          <label for="memo20">배합 20</label>
          <input type="text" id="memo20" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check20">
        </div>
      </div>
    </div>

    <!-- 결과 박스 2 -->
    <div class="memo-section">
      <div class="group-title">B라인</div>
      <div class="result-area" id="resultArea2"></div>
    </div>

    <!-- 추가: 세 번째 메모입력란 -->
    <div class="memo-section" id="memoSection3">
      <div class="memoinput-group">
        <div class="group-title">건조 21 ~ 25</div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo21s" autocomplete="off" placeholder="Lot">
          <label for="memo21">건조 21</label>
          <input type="text" id="memo21" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check21">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo22s" autocomplete="off" placeholder="Lot">
          <label for="memo22">건조 22</label>
          <input type="text" id="memo22" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check22">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo23s" autocomplete="off" placeholder="Lot">
          <label for="memo23">건조 23</label>
          <input type="text" id="memo23" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check23">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo24s" autocomplete="off" placeholder="Lot">
          <label for="memo24">건조 24</label>
          <input type="text" id="memo24" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check24">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo25s" autocomplete="off" placeholder="Lot">
          <label for="memo25">건조 25</label>
          <input type="text" id="memo25" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check25">
        </div>
      </div>
      <div class="memoinput-group">
        <div class="group-title">메모 26 ~ 30</div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo26s" autocomplete="off" placeholder="Lot">
          <label for="memo26">메모 26</label>
          <input type="text" id="memo26" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check26">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo27s" autocomplete="off" placeholder="Lot">
          <label for="memo27">메모 27</label>
          <input type="text" id="memo27" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check27">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo28s" autocomplete="off" placeholder="Lot">
          <label for="memo28">메모 28</label>
          <input type="text" id="memo28" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check28">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo29s" autocomplete="off" placeholder="Lot">
          <label for="memo29">메모 29</label>
          <input type="text" id="memo29" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check29">
        </div>
        <div class="memoline">
          <input type="text" class="memo-small" id="memo30s" autocomplete="off" placeholder="Lot">
          <label for="memo30">메모 30</label>
          <input type="text" id="memo30" class="memo-auto" autocomplete="off">
          <input type="checkbox" class="memocheck" id="check30">
        </div>
      </div>
    </div>

    <!-- 결과 박스 3 -->
    <div class="memo-section">
      <div class="group-title">C라인</div>
      <div class="result-area" id="resultArea3"></div>
    </div>
  </div>

  <script>
    // 메모 필드 id 배열 (기존)
    const memoIds = [
      "memo1", "memo2", "memo3", "memo4", "memo5",
      "memo6", "memo7", "memo8", "memo9", "memo10",
      "memo11", "memo12", "memo13", "memo14", "memo15",
      "memo16", "memo17", "memo18", "memo19", "memo20",
      "memo21", "memo22", "memo23", "memo24", "memo25",
      "memo26", "memo27", "memo28", "memo29", "memo30"
    ];

    // 추가: 작은 입력 필드 id 배열 (_Lot칸, id: memoXs)
    const memoSmallIds = [
      "memo1s", "memo2s", "memo3s", "memo4s", "memo5s",
      "memo6s", "memo7s", "memo8s", "memo9s", "memo10s",
      "memo11s", "memo12s", "memo13s", "memo14s", "memo15s",
      "memo16s", "memo17s", "memo18s", "memo19s", "memo20s",
      "memo21s", "memo22s", "memo23s", "memo24s", "memo25s",
      "memo26s", "memo27s", "memo28s", "memo29s", "memo30s"
    ];

    // 체크박스 id 배열 (1~30)
    const checkIds = [
      "check1","check2","check3","check4","check5",
      "check6","check7","check8","check9","check10",
      "check11","check12","check13","check14","check15",
      "check16","check17","check18","check19","check20",
      "check21","check22","check23","check24","check25",
      "check26","check27","check28","check29","check30"
    ];

    // 각 메모 그룹의 시작 인덱스와 타이틀 정보
    const groups = [
      {start: 0,   end: 9,   resultArea: 'resultArea',   dryLabel: "건조", memoLabel: "배합"},
      {start: 10,  end: 19,  resultArea: 'resultArea2',  dryLabel: "건조", memoLabel: "배합"},
      {start: 20,  end: 29,  resultArea: 'resultArea3',  dryLabel: "건조", memoLabel: "배합"},
    ];

    // 입력란(일반/Lot) 자동 사이즈 조절 함수 (작은 값으로 조정)
    function autoResizeInput(el, pad = 6, min = 13, max = 134) {
      if (!el._measureSpan) {
        const span = document.createElement('span');
        span.style.visibility = 'hidden';
        span.style.position = 'fixed';
        span.style.left = '-9999px';
        span.style.top = '-9999px';
        span.style.font = window.getComputedStyle(el).font;
        span.style.fontSize = window.getComputedStyle(el).fontSize;
        span.style.padding = window.getComputedStyle(el).padding;
        span.style.letterSpacing = window.getComputedStyle(el).letterSpacing;
        span.style.whiteSpace = 'pre';
        span.style.fontFamily = window.getComputedStyle(el).fontFamily;
        el._measureSpan = span;
        document.body.appendChild(span);
      }
      const span = el._measureSpan;
      let v = el.value || el.getAttribute('placeholder') || '';
      span.textContent = v.replace(/ /g, "\u00A0");
      let w = span.offsetWidth + pad;
      w = Math.max(min, w);
      w = Math.min(max, w);
      el.style.width = w + "px";
    }

    // DB Save/Load (전체 30 + 체크박스 + Lot칸)
    function saveMemosToDB(memos, checks, memosSmall) {
      localStorage.setItem('suse_memo_data_v3', JSON.stringify(memos));
      localStorage.setItem('suse_memo_check_v3', JSON.stringify(checks));
      localStorage.setItem('suse_memo_data_small_v3', JSON.stringify(memosSmall));
    }
    function loadMemosFromDB() {
      const val = localStorage.getItem('suse_memo_data_v3');
      if (val) return JSON.parse(val);
      return {};
    }
    function loadChecksFromDB() {
      const val = localStorage.getItem('suse_memo_check_v3');
      if (val) return JSON.parse(val);
      return {};
    }
    function loadMemosSmallFromDB() {
      const val = localStorage.getItem('suse_memo_data_small_v3');
      if (val) return JSON.parse(val);
      return {};
    }

    // 입력값 반영
    function updateResultArea() {
      for (let g = 0; g < groups.length; g++) {
        const group = groups[g];
        let resHtml = "";
        for (let i = group.start; i <= group.end; i++) {
          const val = document.getElementById(memoIds[i]).value.trim();
          const checked = document.getElementById(checkIds[i]).checked;
          const smallVal = document.getElementById(memoSmallIds[i]).value.trim();
          if (val || smallVal) {
            let labelText;
            if (i - group.start < 5) {
              labelText = `${group.dryLabel} ${(i-group.start)+1}`;
            } else {
              labelText = `${group.memoLabel} ${(i-group.start)-4}`;
            }
            let smallText = smallVal ? `<span style="color:#669;font-size:1em;">[${smallVal}]</span> ` : "";
            let valueText = val ? val + " " : "";
            resHtml += `<div><b>${labelText}:</b> ${smallText}${valueText}${checked ? "<span style='color:#635;font-size:0.98em;'>&#10003;</span>" : ""}</div>`;
          }
        }
        document.getElementById(group.resultArea).innerHTML = resHtml || "<div style='color:#aaa'>입력된 메모가 없습니다.</div>";
      }
    }

    // 입력값 저장
    function saveAll() {
      let memos = {};
      let checks = {};
      let memosSmall = {};
      for (let i = 0; i < memoIds.length; i++) {
        memos[memoIds[i]] = document.getElementById(memoIds[i]).value;
        checks[checkIds[i]] = document.getElementById(checkIds[i]).checked ? 1 : 0;
        memosSmall[memoSmallIds[i]] = document.getElementById(memoSmallIds[i]).value;
      }
      saveMemosToDB(memos, checks, memosSmall);
      updateResultArea();
    }

    // 입력란 자동 사이즈 이벤트 연결 (함수)
    function addAutoResizeInputs() {
      // 메모(일반)
      for (let i = 0; i < memoIds.length; i++) {
        const el = document.getElementById(memoIds[i]);
        el.classList.add('memo-auto');
        ["input", "change", "focus"].forEach(evt => {
          el.addEventListener(evt, function() {
            autoResizeInput(el, 13, 30, 134);
          });
        });
        // 최초에도 세팅
        autoResizeInput(el, 13, 30, 134);
      }
      // 메모(Lot)
      for (let i = 0; i < memoSmallIds.length; i++) {
        const el = document.getElementById(memoSmallIds[i]);
        ["input", "change", "focus"].forEach(evt => {
          el.addEventListener(evt, function() {
            autoResizeInput(el, 6, 13, 48);
          });
        });
        autoResizeInput(el, 6, 13, 48);
      }
    }

    // 이벤트 연결
    for (let i = 0; i < memoIds.length; i++) {
      document.getElementById(memoIds[i]).addEventListener('input', saveAll);
      document.getElementById(checkIds[i]).addEventListener('change', saveAll);
      document.getElementById(memoSmallIds[i]).addEventListener('input', saveAll);
    }

    // 초기 로딩
    function loadAll() {
      const memos = loadMemosFromDB();
      const checks = loadChecksFromDB();
      const memosSmall = loadMemosSmallFromDB();
      for (let i = 0; i < memoIds.length; i++) {
        document.getElementById(memoIds[i]).value = memos[memoIds[i]] || "";
        document.getElementById(checkIds[i]).checked = (checks[checkIds[i]] == 1);
        document.getElementById(memoSmallIds[i]).value = memosSmall[memoSmallIds[i]] || "";
      }
      updateResultArea();
      // 입력란 사이즈 조정
      addAutoResizeInputs();
    }
    loadAll();

    // 초기화 (맨위 버튼) - 비밀번호 입력 제거
    document.getElementById('resetBtn').addEventListener('click', function() {
      const confirmed = window.confirm("박스 안에 있는 모든 내용이 초기화 됩니다. 계속하시겠습니까?");
      if (confirmed) {
        for (let i = 0; i < memoIds.length; i++) {
          document.getElementById(memoIds[i]).value = "";
          document.getElementById(checkIds[i]).checked = false;
          document.getElementById(memoSmallIds[i]).value = "";
        }
        saveAll();
        addAutoResizeInputs();
      }
      // 아니오: 아무 일도 없음
    });

    // 입력값 수동 복원(기존) 후에도 입력란 자동 크기 적용
    window.addEventListener('DOMContentLoaded', addAutoResizeInputs);

  </script>
</body>
</html>
